load( "components.asc" );
trace("this is a test1");

//
//function trim (str) 
//{
//	if( typeof str != "string") 
//		return "";
//	str = str.replace(/^\s*/,"");
//	str = str.replace(/\s*$/,"");
//	str = str.replace(/\n/g,"");
//	str = str.replace(/\r/g,"");
//	str = str.replace(/\t/g,"");
//	return str;
//
//};//Ends function trim()
//

users = {};


application.onConnect = function (client, userName)
{
	trace("inside the onConnect function" + userName);
	//userName = trim(userName);
	
	if(userName.length == 0)
	{
		trace("the connection is reject because no username as given");
		application.rejectConnection(client,{msg: "Empty username."});
		return;
	}//Ends if(userName.length==0)
	if (users[userName])
	{	
		trace("the coonection as reject because they are already connected");
		application.rejectConnection(client, {msg: 'The username "' + userName + '" is already in use.'});
		return;
		
	}//Ends if(users[userName])

	users[userName] = client;
	gFrameworkFC.getClientGlobals(client).userName = userName;
	gFrameworkFC.getClientGlobals(client).username = userName;
	trace("the connection is accepted for " + userName + " : " + gFrameworkFC.getClientGlobals(client).userName);
	application.acceptConnection(client);

};//Ends application.onConnect

application.onDisconnect = function (client)
{
	trace("inside the onDisconnect : " + gFrameworkFC.getClientGlobals(client).username);
	var userName = gFrameworkFC.getClientGlobals(client).username;
	delete users[userName];

};//Ends

application.onAppStart = function(){
	trace("this sux!");
};

application.showUsers = function ()
{
	trace("show users : " + users.length );
	var i = 0;
	while (i < users.length)
	{
		trace("user number : " + i.toString() + " has username : " + users[i].username)
		i = i+1; 
	
	}
	
};


trace("this is a test2");







































